<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Precizní Kompas</title>
    <style>
        body {
            margin: 0;
            background-color: #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            color: #5eff5e;
            font-family: monospace;
            overflow: hidden;
            user-select: none;
        }

        /* Horní lišta v jednom řádku */
        #top-bar {
            position: absolute;
            top: 40px;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            letter-spacing: 8px;
            white-space: nowrap;
        }

        #top-indicator {
            position: absolute;
            transition: transform 0.1s linear;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Hlavní kruh */
        #compass-circle {
            width: 280px;
            height: 280px;
            background-color: #0d140d;
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Kontejner šipky - rotuje kolem středu */
        #arrow-pivot {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.1s linear;
        }

        /* Šipka posunutá nahoru od středu */
        .arrow-head {
            width: 0;
            height: 0;
            border-left: 30px solid transparent;
            border-right: 30px solid transparent;
            border-bottom: 55px solid #5eff5e;
            transform: translateY(-40px); /* Vzdálenost špičky od středu */
        }

        /* Fixní středové kolečko */
        #center-dot {
            width: 14px;
            height: 14px;
            background-color: #5eff5e;
            border-radius: 50%;
            z-index: 10;
        }

        #btn-start {
            position: absolute;
            bottom: 60px;
            padding: 15px 30px;
            background: #5eff5e;
            color: #000;
            border: none;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div id="top-bar">
        <div id="top-indicator">
            <span>·</span><span>▲</span><span>·</span><span>·</span><span>·</span><span>·</span><span>●</span><span>·</span><span>·</span><span>·</span><span>·</span><span>·</span><span>·</span>
        </div>
    </div>

    <div id="compass-circle">
        <div id="arrow-pivot">
            <div class="arrow-head"></div>
        </div>
        <div id="center-dot"></div>
    </div>

    <button id="btn-start">AKTIVOVAT SENZORY</button>

    <script>
        const arrowPivot = document.getElementById('arrow-pivot');
        const topIndicator = document.getElementById('top-indicator');
        const btn = document.getElementById('btn-start');

        function updateOrientation(event) {
            // alpha = rotace kolem svislé osy (kompas)
            // Používáme webkitCompassHeading pro iOS (přesnější sever) nebo alpha
            let heading = event.webkitCompassHeading || (360 - event.alpha);
            
            if (heading !== undefined) {
                // 1. Šipka míří stále na stejný bod (sever)
                // Pokud chceš, aby ukazovala na sever, necháme heading. 
                // Pokud chceš, aby "stála" v prostoru, používáme zápornou hodnotu rotace telefonu.
                arrowPivot.style.transform = `rotate(${-heading}deg)`;

                // 2. Horní lišta se posouvá vodorovně
                // Rozsah posunu cca -150px až 150px
                let moveX = ((heading % 360) - 180) * 0.8;
                topIndicator.style.transform = `translateX(${moveX}px)`;
            }
        }

        async function init() {
            if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                const permission = await DeviceOrientationEvent.requestPermission();
                if (permission === 'granted') {
                    window.addEventListener('deviceorientation', updateOrientation);
                    btn.style.display = 'none';
                }
            } else {
                window.addEventListener('deviceorientation', updateOrientation);
                btn.style.display = 'none';
            }
        }

        btn.addEventListener('click', init);
    </script>
</body>
</html>
